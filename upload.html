<!DOCTYPE html>
<html>
<head>
    <title>Channel JSON Upload</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 50px auto; padding: 20px; }
        .container { background: #f5f5f5; padding: 30px; border-radius: 10px; }
        h1 { color: #008753; }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea, select { width: 100%; padding: 10px; border: 1px solid #ddd; }
        button { background: #008753; color: white; border: none; padding: 15px; cursor: pointer; width: 100%; }
        .result { margin-top: 20px; padding: 15px; background: white; }
        .success { background: #e9ffe9; }
        .error { background: #ffe9e9; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Add Video to Channel JSON</h1>
        
        <div class="form-group">
            <label>Channel Name *</label>
            <input type="text" id="channelName" placeholder="e.g., Nyaxo Comedy">
        </div>
        
        <div class="form-group">
            <label>Video Title *</label>
            <input type="text" id="videoTitle" placeholder="e.g., Funny Comedy Skit">
        </div>
        
        <div class="form-group">
            <label>Website URL *</label>
            <input type="url" id="websiteUrl" placeholder="https://rwandacinema.site/comedy/video-slug">
        </div>
        
        <div class="form-group">
            <label>Description</label>
            <textarea id="description" rows="3" placeholder="Video description"></textarea>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div class="form-group">
                <label>Category</label>
                <select id="category">
                    <option value="comedy">Comedy</option>
                    <option value="music">Music</option>
                    <option value="drama">Drama</option>
                    <option value="action">Action</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Duration</label>
                <input type="text" id="duration" placeholder="e.g., 15:30">
            </div>
            
            <div class="form-group">
                <label>Quality</label>
                <select id="quality">
                    <option value="480p">480p SD</option>
                    <option value="720p">720p HD</option>
                    <option value="1080p" selected>1080p Full HD</option>
                    <option value="4K">4K Ultra HD</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Release Year</label>
                <input type="number" id="releaseYear" value="2024">
            </div>
        </div>
        
        <div class="form-group">
            <label>Thumbnail URL</label>
            <input type="url" id="thumbnail" placeholder="https://example.com/thumbnail.jpg">
        </div>
        
        <button onclick="addToChannelJson()">Add Video to Channel JSON</button>
        
        <div id="result" class="result"></div>
    </div>

    <script>
        async function addToChannelJson() {
            const channelName = document.getElementById('channelName').value.trim();
            const videoTitle = document.getElementById('videoTitle').value.trim();
            const websiteUrl = document.getElementById('websiteUrl').value.trim();
            
            if (!channelName || !videoTitle || !websiteUrl) {
                alert('Please fill required fields: Channel Name, Video Title, and Website URL');
                return;
            }
            
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result';
            resultDiv.innerHTML = 'Adding video to channel JSON...';
            
            try {
                // Prepare video data
                const videoData = {
                    videoTitle: videoTitle,
                    websiteUrl: websiteUrl,
                    description: document.getElementById('description').value,
                    category: document.getElementById('category').value,
                    duration: document.getElementById('duration').value,
                    quality: document.getElementById('quality').value,
                    releaseYear: parseInt(document.getElementById('releaseYear').value),
                    thumbnail: document.getElementById('thumbnail').value || '',
                    views: 0,
                    likes: 0
                };
                
                // Call the endpoint
                const response = await fetch('/api/create-md', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        channelName: channelName,
                        videoData: videoData
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <h3>✅ Video Added Successfully!</h3>
                        <p><strong>Channel:</strong> ${channelName}</p>
                        <p><strong>Video:</strong> ${videoTitle}</p>
                        <p><strong>JSON File:</strong> ${data.jsonFile}</p>
                        <p><strong>Total Videos in File:</strong> ${data.videoCount}</p>
                        ${data.nextFile ? `<p><strong>Next JSON File:</strong> ${data.nextFile}</p>` : ''}
                        <p><a href="${data.githubUrl}" target="_blank">View JSON on GitHub</a></p>
                        <p>You can add more videos to the same channel!</p>
                    `;
                    
                    // Clear form
                    document.getElementById('videoTitle').value = '';
                    document.getElementById('websiteUrl').value = '';
                    document.getElementById('description').value = '';
                    
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `
                        <h3>❌ Error</h3>
                        <p>${data.message}</p>
                        ${data.details ? `<pre>${JSON.stringify(data.details, null, 2)}</pre>` : ''}
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `❌ Network Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
